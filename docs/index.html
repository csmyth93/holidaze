<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thailand 2026 - Birkencrocs Crew</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap');
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Prompt', -apple-system, BlinkMacSystemFont, sans-serif; background: linear-gradient(135deg, #fff8e7 0%, #ffe4c4 100%); color: #4a3728; }

        /* Login Page Styles */
        .login-page { display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem; }
        .login-card { background: linear-gradient(135deg, #ffffff 0%, #fffbf5 100%); border-radius: 20px; padding: 3rem; max-width: 420px; width: 100%; box-shadow: 0 10px 40px rgba(180,130,70,0.2); border: 1px solid #e8d4b8; text-align: center; }
        .login-logo { font-size: 4rem; margin-bottom: 1rem; }
        .login-title { font-size: 2rem; color: #c9a227; font-weight: 600; margin-bottom: 0.5rem; }
        .login-subtitle { color: #8b7355; font-size: 1rem; margin-bottom: 0.5rem; }
        .login-dates { color: #e07b39; font-size: 0.9rem; font-weight: 500; margin-bottom: 2rem; }
        .login-form { display: flex; flex-direction: column; gap: 1rem; }
        .login-input { padding: 1rem 1.25rem; border: 2px solid #e8d4b8; border-radius: 12px; font-size: 1rem; font-family: inherit; background: #fffaf0; color: #4a3728; transition: all 0.2s; text-align: center; }
        .login-input:focus { outline: none; border-color: #c9a227; background: #fff; }
        .login-input::placeholder { color: #b8a080; }
        .login-btn { padding: 1rem 2rem; background: linear-gradient(135deg, #c9a227 0%, #daa520 100%); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(201,162,39,0.4); }
        .login-btn:active { transform: translateY(0); }
        .login-error { color: #e74c3c; font-size: 0.85rem; margin-top: 0.5rem; display: none; }
        .login-error.show { display: block; }
        .login-crew { margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid #e8d4b8; }
        .login-crew-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: #b8a080; margin-bottom: 0.75rem; }
        .login-avatars { display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap; }
        .login-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #26a69a 0%, #00897b 100%); display: flex; align-items: center; justify-content: center; font-size: 0.7rem; color: white; font-weight: 500; text-transform: uppercase; cursor: pointer; transition: all 0.2s; }
        .login-avatar:hover { transform: scale(1.1); }
        .login-avatar.cal { background: linear-gradient(135deg, #e07b39 0%, #d35400 100%); }
        .login-avatar.lau { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .login-avatar.and { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); }
        .login-avatar.andr { background: linear-gradient(135deg, #27ae60 0%, #1e8449 100%); }
        .login-avatar.jud { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); }
        .login-avatar.judi { background: linear-gradient(135deg, #f39c12 0%, #d68910 100%); }

        /* User header in app */
        .user-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid #e8d4b8; }
        .user-greeting { font-size: 0.85rem; color: #8b7355; }
        .user-greeting strong { color: #c9a227; }
        .logout-btn { padding: 0.3rem 0.6rem; background: transparent; border: 1px solid #e8d4b8; border-radius: 6px; font-size: 0.7rem; color: #8b7355; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .logout-btn:hover { background: #fff3e0; border-color: #c9a227; color: #c9a227; }

        .app { display: flex; height: 100vh; display: none; }
        .sidebar { width: 400px; background: linear-gradient(180deg, #fffaf0 0%, #fff5e6 100%); overflow-y: auto; padding: 1.5rem; border-right: 1px solid #e8d4b8; box-shadow: 2px 0 20px rgba(180,130,70,0.1); }
        .map-container { flex: 1; position: relative; }
        #map { height: 100%; width: 100%; }
        h1 { font-size: 1.6rem; margin-bottom: 0.5rem; color: #c9a227; font-weight: 600; text-shadow: 1px 1px 0 rgba(255,255,255,0.5); }
        .subtitle { color: #8b7355; font-size: 0.9rem; margin-bottom: 1.5rem; font-weight: 300; }
        .section-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.15em; color: #c9a227; margin: 1.5rem 0 0.75rem; padding-bottom: 0.5rem; border-bottom: 2px solid #f0d590; font-weight: 500; }

        .stay-card { background: linear-gradient(135deg, #ffffff 0%, #fffbf5 100%); border-radius: 12px; padding: 1rem; margin-bottom: 0.75rem; cursor: pointer; transition: all 0.3s; border-left: 4px solid #c9a227; box-shadow: 0 2px 8px rgba(180,130,70,0.1); }
        .stay-card:hover, .stay-card.active { background: linear-gradient(135deg, #fff9e6 0%, #fff3d4 100%); transform: translateX(4px); box-shadow: 0 4px 16px rgba(180,130,70,0.2); }
        .stay-card .location { font-weight: 600; font-size: 1rem; color: #2d5a4a; }
        .stay-card .hotel { font-size: 0.85rem; color: #8b7355; margin-top: 0.25rem; }
        .stay-card .dates { font-size: 0.8rem; color: #e07b39; margin-top: 0.5rem; font-weight: 500; }
        .stay-card .nights { display: inline-block; background: linear-gradient(135deg, #c9a227 0%, #daa520 100%); color: white; padding: 0.2rem 0.6rem; border-radius: 999px; font-size: 0.7rem; margin-left: 0.5rem; font-weight: 500; }
        .stay-card .times { display: flex; gap: 1rem; margin-top: 0.5rem; font-size: 0.75rem; }
        .time-block { flex: 1; }
        .time-label { color: #a08060; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; }
        .time-value { color: #6b5344; }
        .time-exact { color: #0891b2; font-weight: 500; }
        .time-value.departure { color: #e07b39; }

        .weather { display: flex; align-items: center; gap: 0.75rem; margin-top: 0.75rem; padding: 0.6rem 0.75rem; background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); border-radius: 8px; font-size: 0.8rem; border: 1px solid #80deea; }
        .weather-icon { font-size: 1.5rem; }
        .weather-temps { display: flex; flex-direction: column; gap: 0.1rem; }
        .weather-high { color: #e07b39; font-weight: 600; }
        .weather-low { color: #0891b2; font-size: 0.75rem; }
        .weather-details { flex: 1; display: flex; flex-direction: column; gap: 0.1rem; }
        .weather-rain { color: #0891b2; font-size: 0.75rem; }
        .weather-desc { color: #5d8a7a; font-size: 0.7rem; }

        .expand-btn { width: 100%; padding: 0.5rem; margin-top: 0.5rem; background: #faf6f0; border: 1px solid #e8d4b8; border-radius: 6px; color: #6b5344; cursor: pointer; font-size: 0.8rem; display: flex; justify-content: space-between; align-items: center; transition: all 0.2s; }
        .expand-btn:hover { background: #fff3e0; color: #4a3728; border-color: #c9a227; }
        .expand-btn.active { background: #fff3e0; border-color: #c9a227; }
        .expand-btn .arrow { transition: transform 0.2s; }
        .expand-btn.active .arrow { transform: rotate(180deg); }
        .expand-buttons { display: flex; gap: 0.5rem; margin-top: 0.75rem; flex-wrap: wrap; }
        .expand-buttons .expand-btn { flex: 1; min-width: 80px; margin-top: 0; }
        .expand-btn.dinner { border-left: 3px solid #e07b39; }
        .expand-btn.lunch { border-left: 3px solid #2d9a4a; }
        .expand-btn.bars { border-left: 3px solid #9b59b6; }
        .expand-btn.diving { border-left: 3px solid #0891b2; }

        .panel { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; background: #fffbf5; border-radius: 0 0 8px 8px; margin-top: -4px; border: 1px solid #e8d4b8; border-top: none; }
        .panel.open { max-height: 500px; padding: 0.75rem; }

        .attraction-item, .food-item, .dive-item { display: flex; gap: 0.75rem; padding: 0.6rem 0; border-bottom: 1px solid #f0e6d8; }
        .attraction-item:last-child, .food-item:last-child, .dive-item:last-child { border-bottom: none; }
        .attraction-icon, .food-icon, .dive-icon { width: 28px; height: 28px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; background: linear-gradient(135deg, #26a69a 0%, #00897b 100%); }
        .food-icon.dinner { background: linear-gradient(135deg, #e07b39 0%, #d35400 100%); }
        .food-icon.lunch { background: linear-gradient(135deg, #2d9a4a 0%, #1e8449 100%); }
        .food-icon.bar { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .dive-icon { background: linear-gradient(135deg, #0891b2 0%, #0077b6 100%); }
        .attraction-info, .food-info, .dive-info { flex: 1; min-width: 0; }
        .attraction-name, .food-name, .dive-name { font-size: 0.85rem; color: #4a3728; font-weight: 500; }
        .attraction-name a, .food-name a { color: #4a3728; text-decoration: none; border-bottom: 1px dotted #c9a227; transition: all 0.2s; }
        .attraction-name a:hover, .food-name a:hover { color: #c9a227; border-bottom-color: #c9a227; border-bottom-style: solid; }
        .attraction-desc, .food-desc, .dive-desc { font-size: 0.75rem; color: #8b7355; margin-top: 0.15rem; }
        .food-cuisine { font-size: 0.7rem; color: #e07b39; background: rgba(224,123,57,0.1); padding: 0.1rem 0.4rem; border-radius: 4px; font-weight: 500; }
        .dive-depth { font-size: 0.7rem; color: #0891b2; font-weight: 500; }

        /* Favorite button styles */
        .fav-btn { background: none; border: none; cursor: pointer; font-size: 1rem; padding: 0.2rem; margin-left: auto; color: #ccc; transition: all 0.2s; flex-shrink: 0; }
        .fav-btn:hover { transform: scale(1.2); color: #e74c3c; }
        .fav-btn.favorited { color: #e74c3c; }
        .attraction-item, .food-item, .dive-item { align-items: flex-start; }

        /* Favorites floating button and panel */
        .fav-map-btn { position: absolute; top: 10px; right: 10px; z-index: 1000; width: 44px; height: 44px; border-radius: 50%; background: linear-gradient(135deg, #fff 0%, #fffbf5 100%); border: 2px solid #e8d4b8; box-shadow: 0 2px 8px rgba(0,0,0,0.15); cursor: pointer; font-size: 1.3rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s; }
        .fav-map-btn:hover { transform: scale(1.1); border-color: #e74c3c; }
        .fav-map-btn.active { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); border-color: #c0392b; color: white; }
        .fav-map-btn .fav-count { position: absolute; top: -4px; right: -4px; background: #e74c3c; color: white; font-size: 0.65rem; font-weight: 600; min-width: 18px; height: 18px; border-radius: 9px; display: flex; align-items: center; justify-content: center; }
        .fav-map-btn.active .fav-count { background: #fff; color: #e74c3c; }

        .fav-panel { position: absolute; top: 60px; right: 10px; z-index: 1000; width: 300px; max-height: calc(100% - 80px); background: linear-gradient(135deg, #fff 0%, #fffbf5 100%); border-radius: 12px; border: 1px solid #e8d4b8; box-shadow: 0 4px 20px rgba(0,0,0,0.15); overflow: hidden; display: none; }
        .fav-panel.open { display: flex; flex-direction: column; }
        .fav-panel-header { padding: 0.75rem 1rem; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; font-weight: 600; font-size: 0.9rem; }
        .fav-panel-content { flex: 1; overflow-y: auto; padding: 0.5rem; }
        .fav-panel-empty { padding: 2rem 1rem; text-align: center; color: #8b7355; font-size: 0.85rem; }
        .fav-panel-category { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: #8b7355; padding: 0.5rem 0.5rem 0.25rem; margin-top: 0.5rem; }
        .fav-panel-category:first-child { margin-top: 0; }
        .fav-panel-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; background: #fff; border-radius: 8px; margin-bottom: 0.25rem; cursor: pointer; transition: all 0.2s; border: 1px solid transparent; }
        .fav-panel-item:hover { border-color: #e8d4b8; background: #fffbf5; }
        .fav-panel-item .fav-icon { width: 24px; height: 24px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; flex-shrink: 0; }
        .fav-panel-item .fav-icon.attractions { background: linear-gradient(135deg, #26a69a 0%, #00897b 100%); }
        .fav-panel-item .fav-icon.dinner { background: linear-gradient(135deg, #e07b39 0%, #d35400 100%); }
        .fav-panel-item .fav-icon.lunch { background: linear-gradient(135deg, #2d9a4a 0%, #1e8449 100%); }
        .fav-panel-item .fav-icon.bars { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .fav-panel-item .fav-icon.diving { background: linear-gradient(135deg, #0891b2 0%, #0077b6 100%); }
        .fav-panel-item .fav-name { flex: 1; font-size: 0.8rem; color: #4a3728; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .fav-panel-item .fav-location { font-size: 0.65rem; color: #8b7355; white-space: nowrap; }
        .fav-panel-item .fav-remove { color: #ccc; font-size: 0.9rem; padding: 0.2rem; cursor: pointer; transition: color 0.2s; }
        .fav-panel-item .fav-remove:hover { color: #e74c3c; }

        @media (max-width: 768px) {
            .fav-panel { width: calc(100% - 20px); max-height: 50%; }
        }

        .transfer-card { background: linear-gradient(135deg, #ffffff 0%, #fffbf5 100%); border-radius: 8px; padding: 0.75rem 1rem; margin-bottom: 0.5rem; font-size: 0.85rem; display: flex; align-items: center; gap: 0.75rem; border: 1px solid #e8d4b8; }
        .transfer-icon { font-size: 1.2rem; }
        .transfer-details { flex: 1; }
        .transfer-route { color: #4a3728; font-weight: 500; }
        .transfer-type { font-size: 0.75rem; color: #8b7355; }

        .legend { display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem; color: #6b5344; }
        .legend-line { width: 24px; height: 3px; border-radius: 2px; }
        .legend-line.flight { background: linear-gradient(90deg, #e07b39, #c9a227); }
        .legend-line.ferry { background: linear-gradient(90deg, #0891b2, #26a69a); }
        .legend-line.transfer { background: linear-gradient(90deg, #c9a227, #f0d590); }

        .leaflet-popup-content-wrapper { background: linear-gradient(135deg, #fffaf0 0%, #fff5e6 100%); color: #4a3728; border-radius: 12px; box-shadow: 0 4px 20px rgba(180,130,70,0.25); }
        .leaflet-popup-tip { background: #fff5e6; }
        .leaflet-popup-content { margin: 12px 16px; }
        .popup-title { font-weight: 600; font-size: 1rem; margin-bottom: 0.25rem; color: #2d5a4a; }
        .popup-subtitle, .popup-type { font-size: 0.85rem; color: #8b7355; }
        .popup-desc { font-size: 0.8rem; color: #6b5344; margin-top: 0.25rem; }
        .popup-link { display: inline-block; margin-top: 0.5rem; padding: 0.3rem 0.6rem; background: linear-gradient(135deg, #c9a227 0%, #daa520 100%); color: #fff; font-size: 0.75rem; font-weight: 600; text-decoration: none; border-radius: 6px; transition: all 0.2s; box-shadow: 0 2px 4px rgba(180,130,70,0.3); }
        .popup-link:hover { background: linear-gradient(135deg, #daa520 0%, #c9a227 100%); transform: translateY(-1px); }

        .custom-marker { background: linear-gradient(135deg, #c9a227 0%, #daa520 100%); border: 3px solid #fff; border-radius: 50%; box-shadow: 0 2px 8px rgba(180,130,70,0.4); }
        .custom-marker.island { background: linear-gradient(135deg, #26a69a 0%, #00897b 100%); }
        .custom-marker.airport { background: linear-gradient(135deg, #e07b39 0%, #d35400 100%); }

        .poi-marker { border: 2px solid #fff; border-radius: 50%; box-shadow: 0 2px 6px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; font-size: 12px; }
        .poi-marker.attraction { background: linear-gradient(135deg, #26a69a 0%, #00897b 100%); }
        .poi-marker.dinner { background: linear-gradient(135deg, #e07b39 0%, #d35400 100%); }
        .poi-marker.lunch { background: linear-gradient(135deg, #2d9a4a 0%, #1e8449 100%); }
        .poi-marker.bars { background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); }
        .poi-marker.diving { background: linear-gradient(135deg, #0891b2 0%, #0077b6 100%); }

        .area-summary { font-size: 0.8rem; color: #6b5344; margin-top: 0.75rem; padding: 0.75rem; background: linear-gradient(135deg, #f5f0e8 0%, #efe8dd 100%); border-radius: 8px; line-height: 1.5; border-left: 3px solid #c9a227; }

        /* Drag handle for mobile sidebar resize */
        .drag-handle { display: none; }

        @media (max-width: 768px) {
            .app { flex-direction: column; }
            .sidebar { width: 100%; height: 40vh; order: 2; border-radius: 16px 16px 0 0; border-right: none; border-top: 1px solid #e8d4b8; padding-top: 0.5rem; }
            .map-container { flex: 1; order: 1; height: auto; }
            .drag-handle { display: flex; justify-content: center; align-items: center; padding: 0.5rem 0; cursor: grab; touch-action: none; }
            .drag-handle:active { cursor: grabbing; }
            .drag-handle-bar { width: 40px; height: 5px; background: #d4c4a8; border-radius: 3px; }
            .sidebar.dragging { transition: none; }
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-page" id="loginPage">
        <div class="login-card">
            <div class="login-logo">üå¥</div>
            <h1 class="login-title">Thailand 2026</h1>
            <p class="login-subtitle">Birkencrocs Crew Adventure</p>
            <p class="login-dates">March 14 - 28 ¬∑ Andaman Islands</p>
            <form class="login-form" id="loginForm">
                <input type="text" class="login-input" id="usernameInput" placeholder="Enter your name" autocomplete="off" autofocus>
                <button type="submit" class="login-btn">Let's Go! ‚úàÔ∏è</button>
                <p class="login-error" id="loginError">Hmm, that name isn't on the crew list!</p>
            </form>
            <div class="login-crew">
                <p class="login-crew-title">The Crew</p>
                <div class="login-avatars">
                    <div class="login-avatar cal" data-name="callum">Cal</div>
                    <div class="login-avatar lau" data-name="laura">Lau</div>
                    <div class="login-avatar and" data-name="andy">Andy</div>
                    <div class="login-avatar jud" data-name="jude">Jude</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="app" id="mainApp">
        <aside class="sidebar" id="sidebar">
            <div class="drag-handle" id="dragHandle">
                <div class="drag-handle-bar"></div>
            </div>
            <div class="user-header">
                <span class="user-greeting">Welcome, <strong id="userName"></strong>!</span>
                <button class="logout-btn" id="logoutBtn">Sign out</button>
            </div>
            <h1>Thailand 2026</h1>
            <p class="subtitle">Andaman Coast Island Hopping<br>March 14 - 28</p>
            <h3 class="section-title">Stays</h3>
            <div id="stays-list"></div>
            <h3 class="section-title">Route</h3>
            <div id="transfers-list"></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-line flight"></div><span>Flight</span></div>
                <div class="legend-item"><div class="legend-line ferry"></div><span>Ferry/Boat</span></div>
                <div class="legend-item"><div class="legend-line transfer"></div><span>Van/Transfer</span></div>
            </div>
        </aside>
        <div class="map-container">
            <div id="map"></div>
            <button class="fav-map-btn" id="favMapBtn" title="My Favorites">
                <span class="fav-count" id="favCount" style="display:none">0</span>
            </button>
            <div class="fav-panel" id="favPanel">
                <div class="fav-panel-header">My Favorites</div>
                <div class="fav-panel-content" id="favPanelContent">
                    <div class="fav-panel-empty">No favorites yet. Click the heart on any item to add it here.</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const data = {
  "locations": {
    "bangkok": {
      "name": "Bangkok",
      "address": "Bangkok, Thailand",
      "lat": 13.7563,
      "lng": 100.5018,
      "type": "city"
    },
    "hat_yai": {
      "name": "Hat Yai Airport",
      "address": "Hat Yai International Airport, Khlong La, Khuan Niang, Songkhla 90110",
      "lat": 6.9331,
      "lng": 100.3928,
      "type": "airport",
      "iata": "HDY"
    },
    "koh_lipe": {
      "name": "Koh Lipe",
      "address": "Pattaya Beach Pier, Koh Lipe, Satun 91000",
      "lat": 6.485,
      "lng": 99.3015,
      "type": "island"
    },
    "koh_libong": {
      "name": "Koh Libong",
      "address": "Koh Libong Pier, Kantang, Trang 92110",
      "lat": 7.215,
      "lng": 99.405,
      "type": "island"
    },
    "koh_kradan": {
      "name": "Koh Kradan",
      "address": "Koh Kradan, Kantang, Trang 92110",
      "lat": 7.31,
      "lng": 99.2531,
      "type": "island"
    },
    "koh_lanta": {
      "name": "Koh Lanta",
      "address": "Saladan Pier, Koh Lanta, Krabi 81150",
      "lat": 7.6505,
      "lng": 99.0397,
      "type": "island"
    },
    "krabi": {
      "name": "Krabi Airport",
      "address": "Krabi International Airport, Nuea Khlong, Krabi 81130",
      "lat": 8.0986,
      "lng": 98.9862,
      "type": "airport",
      "iata": "KBV"
    }
  },
  "route": [
    {
      "from": "bangkok",
      "to": "hat_yai",
      "type": "flight",
      "date": "2026-03-16",
      "label": "Air Asia"
    },
    {
      "from": "hat_yai",
      "to": "koh_lipe",
      "type": "transfer",
      "date": "2026-03-16",
      "label": "Van + Speedboat"
    },
    {
      "from": "koh_lipe",
      "to": "koh_libong",
      "type": "ferry",
      "date": "2026-03-19",
      "label": "Ferry"
    },
    {
      "from": "koh_libong",
      "to": "koh_kradan",
      "type": "ferry",
      "date": "2026-03-21",
      "label": "Longtail Boat"
    },
    {
      "from": "koh_kradan",
      "to": "koh_lanta",
      "type": "ferry",
      "date": "2026-03-23",
      "label": "Ferry"
    },
    {
      "from": "koh_lanta",
      "to": "krabi",
      "type": "transfer",
      "date": "2026-03-27",
      "label": "Van"
    },
    {
      "from": "krabi",
      "to": "bangkok",
      "type": "flight",
      "date": "2026-03-27",
      "label": "Air Asia"
    }
  ],
  "stays": [
    {
      "location": "bangkok",
      "hotel": "Salil Hotel Sukhumvit Soi 11",
      "hotelLat": 13.7428,
      "hotelLng": 100.5553,
      "start": "2026-03-14",
      "end": "2026-03-16",
      "nights": 2,
      "arrival": "evening",
      "arrivalTime": "17:45",
      "departure": "morning",
      "departureTime": "08:30",
      "weather": {
        "high": 35,
        "low": 26,
        "condition": "sunny",
        "rain": 5,
        "humidity": 65,
        "desc": "Hot & dry season"
      },
      "attractions": [
        {
          "id": "bkk_grandpalace",
          "name": "Grand Palace & Wat Phra Kaew",
          "type": "cultural",
          "desc": "Thailand's most sacred Buddhist temple",
          "lat": 13.75,
          "lng": 100.4914,
          "website": "https://www.royalgrandpalace.th/"
        },
        {
          "id": "bkk_watarun",
          "name": "Wat Arun",
          "type": "cultural",
          "desc": "Iconic Temple of Dawn on the river",
          "lat": 13.7435,
          "lng": 100.4874,
          "website": "https://www.google.com/maps/search/Wat+Arun+Bangkok"
        },
        {
          "id": "bkk_chatuchak",
          "name": "Chatuchak Weekend Market",
          "type": "activity",
          "desc": "World's largest weekend market",
          "lat": 13.7999,
          "lng": 100.5504,
          "website": "https://www.chatuchakmarket.org/"
        },
        {
          "id": "bkk_watpho",
          "name": "Wat Pho",
          "type": "cultural",
          "desc": "Giant reclining Buddha & traditional massage school",
          "lat": 13.7465,
          "lng": 100.493,
          "website": "https://www.watpho.com/"
        },
        {
          "id": "bkk_jimthompson",
          "name": "Jim Thompson House",
          "type": "cultural",
          "desc": "Silk merchant's stunning teak house museum",
          "lat": 13.7493,
          "lng": 100.5293,
          "website": "https://www.google.com/maps/search/Jim+Thompson+House+Bangkok"
        }
      ],
      "dinner": [
        {
          "id": "bkk_gaggan",
          "name": "Gaggan Anand",
          "cuisine": "Indian",
          "desc": "World-famous progressive Indian fine dining",
          "lat": 13.7355,
          "lng": 100.5687,
          "website": "https://gaggan.com/"
        },
        {
          "id": "bkk_nahm",
          "name": "Nahm",
          "cuisine": "Thai",
          "desc": "Elegant Thai cuisine, Michelin starred",
          "lat": 13.7226,
          "lng": 100.529,
          "website": "https://www.comohotels.com/en/metropolitanbangkok/dining/nahm"
        },
        {
          "id": "bkk_bolan",
          "name": "Bo.lan",
          "cuisine": "Thai",
          "desc": "Sustainable farm-to-table Thai",
          "lat": 13.7305,
          "lng": 100.5724,
          "website": "https://www.bolan.co.th/"
        },
        {
          "id": "bkk_issaya",
          "name": "Issaya Siamese Club",
          "cuisine": "Thai",
          "desc": "Thai fine dining in a garden villa",
          "lat": 13.722,
          "lng": 100.5352,
          "website": "https://www.issaya.com/"
        },
        {
          "id": "bkk_suhring",
          "name": "S\u00fchring",
          "cuisine": "German",
          "desc": "Twin chefs' modern German, 3 Michelin stars",
          "lat": 13.701,
          "lng": 100.5449,
          "website": "https://restaurantsuhring.com/"
        }
      ],
      "lunch": [
        {
          "id": "bkk_thipsamai",
          "name": "Thipsamai",
          "cuisine": "Thai",
          "desc": "Legendary pad thai since 1966",
          "lat": 13.7528,
          "lng": 100.5047,
          "website": "https://thipsamai.com/"
        },
        {
          "id": "bkk_jayfai",
          "name": "Jay Fai",
          "cuisine": "Thai",
          "desc": "Street food queen, Michelin starred crab omelette",
          "lat": 13.7533,
          "lng": 100.5052,
          "website": "https://www.instagram.com/jayfaibangkok/"
        },
        {
          "id": "bkk_somtamnua",
          "name": "Som Tam Nua",
          "cuisine": "Isaan",
          "desc": "Famous papaya salad & fried chicken",
          "lat": 13.7457,
          "lng": 100.5341,
          "website": null
        },
        {
          "id": "bkk_burapa",
          "name": "Burapa",
          "cuisine": "Thai",
          "desc": "Eastern Thai with creative twist, Bib Gourmand",
          "lat": 13.7421,
          "lng": 100.5548,
          "website": null
        },
        {
          "id": "bkk_appia",
          "name": "Appia",
          "cuisine": "Italian",
          "desc": "Authentic Roman trattoria hidden in Sukhumvit",
          "lat": 13.7362,
          "lng": 100.568,
          "website": "https://www.google.com/search?q=Appia+Restaurant+Bangkok+Sukhumvit+31"
        }
      ],
      "bars": [
        {
          "id": "bkk_havana",
          "name": "Havana Social",
          "type": "Speakeasy",
          "desc": "Hidden Cuban bar behind a phone booth, great cocktails",
          "lat": 13.7425,
          "lng": 100.5545,
          "website": "https://www.google.com/search?q=Havana+Social+Bangkok"
        },
        {
          "id": "bkk_octave",
          "name": "Octave Rooftop Bar",
          "type": "Rooftop",
          "desc": "360\u00b0 views from 45th floor, three-tiered rooftop",
          "lat": 13.726,
          "lng": 100.585,
          "website": "https://www.google.com/search?q=Octave+Rooftop+Bar+Bangkok"
        },
        {
          "id": "bkk_sugarcane",
          "name": "Sugar Cane",
          "type": "Cocktail Bar",
          "desc": "Tropical cocktails in a garden setting",
          "lat": 13.742,
          "lng": 100.555,
          "website": "https://www.google.com/search?q=Sugar+Cane+Bar+Bangkok"
        },
        {
          "id": "bkk_beam",
          "name": "BEAM",
          "type": "Club/Bar",
          "desc": "Underground club with top DJs and craft cocktails",
          "lat": 13.731,
          "lng": 100.579,
          "website": "https://www.google.com/search?q=BEAM+Club+Bangkok"
        },
        {
          "id": "bkk_brownsugar",
          "name": "Brown Sugar: The Jazz Boutique",
          "type": "Jazz Bar",
          "desc": "Bangkok's legendary live jazz venue since 1985",
          "lat": 13.762,
          "lng": 100.498,
          "website": "https://www.google.com/search?q=Brown+Sugar+Jazz+Bangkok"
        }
      ],
      "diving": null,
      "summary": "Sukhumvit Soi 11 is Bangkok's party central - packed with rooftop bars, international restaurants, and nightclubs. The BTS Nana station is a 5-min walk, making the whole city accessible. Great for first-night energy before heading south."
    },
    {
      "location": "koh_lipe",
      "hotel": "Lipe Beach Resort",
      "hotelLat": 6.4908,
      "hotelLng": 99.3073,
      "start": "2026-03-16",
      "end": "2026-03-19",
      "nights": 3,
      "arrival": "afternoon",
      "arrivalTime": "15:10",
      "departure": "midday",
      "departureTime": "12:30",
      "weather": {
        "high": 32,
        "low": 26,
        "condition": "sunny",
        "rain": 10,
        "humidity": 75,
        "desc": "Dry season, calm seas"
      },
      "attractions": [
        {
          "id": "lipe_sunrise",
          "name": "Sunrise Beach",
          "type": "beach",
          "desc": "Best beach for sunrise views & swimming",
          "lat": 6.493,
          "lng": 99.3089,
          "website": "https://www.google.com/maps/search/Sunrise+Beach+Koh+Lipe"
        },
        {
          "id": "lipe_walkingstreet",
          "name": "Walking Street",
          "type": "nightlife",
          "desc": "Beach bars, restaurants & night market",
          "lat": 6.487,
          "lng": 99.304,
          "website": "https://www.google.com/maps/search/Walking+Street+Koh+Lipe"
        },
        {
          "id": "lipe_sunsetbeach",
          "name": "Sunset Beach",
          "type": "beach",
          "desc": "Quiet beach with stunning sunset views",
          "lat": 6.4862,
          "lng": 99.2948,
          "website": "https://www.google.com/maps/search/Sunset+Beach+Koh+Lipe"
        },
        {
          "id": "lipe_chadocliff",
          "name": "Chado Cliff Viewpoint",
          "type": "nature",
          "desc": "Hike on Koh Adang for panoramic views",
          "lat": 6.538,
          "lng": 99.282,
          "website": "https://www.google.com/maps/search/Chado+Cliff+Koh+Adang"
        },
        {
          "id": "lipe_pattayabeach",
          "name": "Pattaya Beach",
          "type": "beach",
          "desc": "Main beach with ferry pier & cafes",
          "lat": 6.483,
          "lng": 99.299,
          "website": "https://www.google.com/maps/search/Pattaya+Beach+Koh+Lipe"
        }
      ],
      "dinner": [
        {
          "id": "lipe_elephant",
          "name": "Elephant Beach Bar",
          "cuisine": "Thai/Western",
          "desc": "Beachfront dining with fire shows",
          "lat": 6.4908,
          "lng": 99.3073,
          "website": "https://lipebeachresort.com/restaurantbar/"
        },
        {
          "id": "lipe_papayamom",
          "name": "Papaya Mom",
          "cuisine": "Thai",
          "desc": "Famous Walking Street Thai restaurant",
          "lat": 6.487,
          "lng": 99.304,
          "website": "https://www.instagram.com/papayamomkohlipe/"
        },
        {
          "id": "lipe_tenmoons",
          "name": "Ten Moons",
          "cuisine": "Spanish/Thai",
          "desc": "Upscale beachfront Mediterranean-Thai fusion",
          "lat": 6.4838,
          "lng": 99.3095,
          "website": "https://www.tenmoonsliperesort.com/restaurant/"
        },
        {
          "id": "lipe_laluna",
          "name": "La Luna",
          "cuisine": "Italian",
          "desc": "Handmade pasta & fresh-baked bread",
          "lat": 6.4872,
          "lng": 99.3038,
          "website": null
        },
        {
          "id": "lipe_ontherocks",
          "name": "On The Rocks",
          "cuisine": "Thai/Seafood",
          "desc": "Romantic oceanfront at Serendipity Resort",
          "lat": 6.492,
          "lng": 99.3082,
          "website": "https://www.google.com/search?q=On+The+Rocks+Serendipity+Resort+Koh+Lipe"
        }
      ],
      "lunch": [
        {
          "id": "lipe_pancakelady",
          "name": "Thai Pancake Lady",
          "cuisine": "Cafe",
          "desc": "Famous banana pancakes & smoothies",
          "lat": 6.4868,
          "lng": 99.3045,
          "website": null
        },
        {
          "id": "lipe_thebox",
          "name": "The Box",
          "cuisine": "Mediterranean",
          "desc": "Stylish Spanish sandwiches on crusty bread",
          "lat": 6.4865,
          "lng": 99.3042,
          "website": "https://www.instagram.com/theboxkohlipe/"
        },
        {
          "id": "lipe_bombay",
          "name": "Bombay",
          "cuisine": "Indian",
          "desc": "Authentic curries with spices from India",
          "lat": 6.4867,
          "lng": 99.3035,
          "website": null
        },
        {
          "id": "lipe_flourflourbakery",
          "name": "Flour Flour Bakery",
          "cuisine": "Bakery",
          "desc": "Fresh pastries, coffee & light bites",
          "lat": 6.4871,
          "lng": 99.3048,
          "website": null
        },
        {
          "id": "lipe_poohbar",
          "name": "Pooh's Bar & Restaurant",
          "cuisine": "Thai",
          "desc": "Beachfront Thai classics & cocktails",
          "lat": 6.4835,
          "lng": 99.2985,
          "website": "https://www.instagram.com/poohsbarkohlipe/"
        }
      ],
      "bars": [
        {
          "id": "lipe_jacks",
          "name": "Jack's Jungle Bar",
          "type": "Beach Bar",
          "desc": "Legendary reggae bar with fire shows and buckets",
          "lat": 6.4868,
          "lng": 99.3038,
          "website": "https://www.google.com/search?q=Jacks+Jungle+Bar+Koh+Lipe"
        },
        {
          "id": "lipe_karma",
          "name": "Karma Beach Bar",
          "type": "Beach Bar",
          "desc": "Sunset cocktails on Pattaya Beach",
          "lat": 6.4835,
          "lng": 99.2982,
          "website": "https://www.google.com/search?q=Karma+Beach+Bar+Koh+Lipe"
        },
        {
          "id": "lipe_reggae",
          "name": "Reggae Bar",
          "type": "Beach Bar",
          "desc": "Chilled vibes, cheap beers, live music some nights",
          "lat": 6.4872,
          "lng": 99.3042,
          "website": "https://www.google.com/search?q=Reggae+Bar+Koh+Lipe"
        },
        {
          "id": "lipe_castaway",
          "name": "Castaway Resort Bar",
          "type": "Beach Bar",
          "desc": "Romantic Sunrise Beach spot with fairy lights",
          "lat": 6.4915,
          "lng": 99.3078,
          "website": "https://www.google.com/search?q=Castaway+Resort+Bar+Koh+Lipe"
        },
        {
          "id": "lipe_oasis",
          "name": "Oasis Bar",
          "type": "Beach Bar",
          "desc": "Late night party spot with DJ sets",
          "lat": 6.4865,
          "lng": 99.3035,
          "website": "https://www.google.com/search?q=Oasis+Bar+Koh+Lipe"
        }
      ],
      "diving": [
        {
          "id": "lipe_8mile",
          "name": "8 Mile Rock",
          "depth": "12-30m",
          "desc": "Pinnacle with leopard sharks, barracuda & large pelagics",
          "lat": 6.345,
          "lng": 99.31
        },
        {
          "id": "lipe_stonehenge",
          "name": "Stonehenge",
          "depth": "10-30m",
          "desc": "Boulder formations with soft corals & reef fish",
          "lat": 6.4874,
          "lng": 99.3332
        },
        {
          "id": "lipe_kohadang",
          "name": "Koh Adang Reef",
          "depth": "5-18m",
          "desc": "Easy reef dive, great for beginners, turtles common",
          "lat": 6.535,
          "lng": 99.278
        },
        {
          "id": "lipe_yonghua",
          "name": "Yong Hua Wreck",
          "depth": "28-42m",
          "desc": "Advanced dive, cargo ship with resident groupers",
          "lat": 6.442,
          "lng": 99.252
        }
      ],
      "summary": "Thailand's southernmost paradise near the Malaysian border. Tiny island with three beaches, no cars, and a backpacker vibe. Walking Street connects Pattaya and Sunrise beaches with bars, restaurants, and shops. Crystal clear water for snorkeling right off the beach."
    },
    {
      "location": "koh_libong",
      "hotel": "Le Dugong Libong Beach Resort",
      "hotelLat": 7.2283,
      "hotelLng": 99.3667,
      "start": "2026-03-19",
      "end": "2026-03-21",
      "nights": 2,
      "arrival": "afternoon",
      "arrivalTime": "15:00",
      "departure": "late morning",
      "departureTime": "11:30",
      "weather": {
        "high": 32,
        "low": 26,
        "condition": "partly_cloudy",
        "rain": 15,
        "humidity": 78,
        "desc": "Warm & clear for dugong spotting"
      },
      "attractions": [
        {
          "id": "libong_dugong_watch",
          "name": "Dugong Watching",
          "type": "wildlife",
          "desc": "See rare sea cows in their natural habitat",
          "lat": 7.205,
          "lng": 99.42,
          "website": "https://www.google.com/maps/search/Dugong+Watching+Koh+Libong"
        },
        {
          "id": "libong_stonebridge",
          "name": "Stone Bridge",
          "type": "nature",
          "desc": "Natural rock formation with tunnel to sea",
          "lat": 7.245,
          "lng": 99.35,
          "website": "https://www.google.com/maps/search/Stone+Bridge+Koh+Libong"
        },
        {
          "id": "libong_batubute",
          "name": "Batu Bute Village",
          "type": "cultural",
          "desc": "Colorful fishing village with stilt houses",
          "lat": 7.215,
          "lng": 99.405,
          "website": "https://www.google.com/maps/search/Batu+Bute+Village+Koh+Libong"
        },
        {
          "id": "libong_langkhao",
          "name": "Haad Lang Khao Beach",
          "type": "beach",
          "desc": "Main swimming beach with calm waters",
          "lat": 7.23,
          "lng": 99.365,
          "website": "https://www.google.com/maps/search/Haad+Lang+Khao+Beach+Koh+Libong"
        },
        {
          "id": "libong_dugongtower",
          "name": "Dugong Spotting Tower",
          "type": "wildlife",
          "desc": "5-story tower at end of Leekpai Pier",
          "lat": 7.21,
          "lng": 99.41,
          "website": "https://www.google.com/maps/search/Dugong+Spotting+Tower+Koh+Libong"
        }
      ],
      "dinner": [
        {
          "id": "libong_ledugong_rest",
          "name": "Le Dugong Restaurant",
          "cuisine": "Thai/Western",
          "desc": "Resort restaurant with sea views",
          "lat": 7.2283,
          "lng": 99.3667,
          "website": null
        },
        {
          "id": "libong_libongbeach",
          "name": "Libong Beach Resort",
          "cuisine": "Thai/Seafood",
          "desc": "Fresh seafood by the beach",
          "lat": 7.232,
          "lng": 99.368,
          "website": null
        },
        {
          "id": "libong_andalay",
          "name": "Andalay Beach Resort",
          "cuisine": "Thai",
          "desc": "Relaxed beachfront dining",
          "lat": 7.23,
          "lng": 99.3695,
          "website": null
        },
        {
          "id": "libong_pier",
          "name": "Pier Restaurant",
          "cuisine": "Thai/Seafood",
          "desc": "Dine over the water watching fish below",
          "lat": 7.215,
          "lng": 99.405,
          "website": null
        },
        {
          "id": "libong_starcoffee",
          "name": "Star Coffee Bar",
          "cuisine": "Thai/Western",
          "desc": "Local favorite run by helpful owner",
          "lat": 7.22,
          "lng": 99.385,
          "website": null
        }
      ],
      "lunch": [
        {
          "id": "libong_streetfood",
          "name": "Morning Street Food",
          "cuisine": "Thai",
          "desc": "Fried chicken, noodles & sticky rice",
          "lat": 7.218,
          "lng": 99.39,
          "website": null
        },
        {
          "id": "libong_starcoffee_lunch",
          "name": "Star Coffee Cafe",
          "cuisine": "Cafe",
          "desc": "Coffee, smoothies & light meals",
          "lat": 7.22,
          "lng": 99.385,
          "website": null
        }
      ],
      "bars": [
        {
          "id": "libong_resortbar",
          "name": "Le Dugong Resort Bar",
          "type": "Resort Bar",
          "desc": "Only real bar on the island - cold beers at sunset",
          "lat": 7.2283,
          "lng": 99.3667,
          "website": "https://www.google.com/search?q=Le+Dugong+Resort+Koh+Libong"
        }
      ],
      "diving": null,
      "summary": "Off-the-beaten-path island famous for dugong (sea cow) sightings in the seagrass beds. A Muslim fishing community with zero nightlife - just beaches, mangroves, and incredible wildlife. The ultimate digital detox before the livelier islands."
    },
    {
      "location": "koh_kradan",
      "hotel": "Kradan Beach Resort",
      "hotelLat": 7.3127,
      "hotelLng": 99.2564,
      "start": "2026-03-21",
      "end": "2026-03-23",
      "nights": 2,
      "arrival": "midday",
      "arrivalTime": "12:30",
      "departure": "morning",
      "departureTime": "10:45",
      "weather": {
        "high": 32,
        "low": 27,
        "condition": "sunny",
        "rain": 10,
        "humidity": 76,
        "desc": "Perfect snorkeling conditions"
      },
      "attractions": [
        {
          "id": "kradan_emerald",
          "name": "Emerald Cave (Tham Morakot)",
          "type": "nature",
          "desc": "Swim through dark cave to hidden lagoon",
          "lat": 7.3695,
          "lng": 99.292,
          "website": "https://www.google.com/maps/search/Emerald+Cave+Tham+Morakot+Koh+Mook"
        },
        {
          "id": "kradan_paradisebeach",
          "name": "Paradise Beach",
          "type": "beach",
          "desc": "1.5km of pristine white sand",
          "lat": 7.314,
          "lng": 99.255,
          "website": "https://www.google.com/maps/search/Paradise+Beach+Koh+Kradan"
        },
        {
          "id": "kradan_aoniang",
          "name": "Ao Niang Beach",
          "type": "beach",
          "desc": "Secluded cove with best snorkeling",
          "lat": 7.305,
          "lng": 99.248,
          "website": "https://www.google.com/maps/search/Ao+Niang+Beach+Koh+Kradan"
        },
        {
          "id": "kradan_jungletrek",
          "name": "Jungle Trek",
          "type": "nature",
          "desc": "Trail through jungle to hidden beaches",
          "lat": 7.31,
          "lng": 99.25,
          "website": "https://www.google.com/maps/search/Koh+Kradan+Jungle+Trek"
        },
        {
          "id": "kradan_kayaking",
          "name": "Kayaking & Paddleboarding",
          "type": "activity",
          "desc": "Explore crystal clear waters by kayak",
          "lat": 7.3145,
          "lng": 99.2555,
          "website": "https://www.google.com/maps/search/Kayaking+Koh+Kradan"
        }
      ],
      "dinner": [
        {
          "id": "kradan_beach_resort_rest",
          "name": "Kradan Beach Resort Restaurant",
          "cuisine": "Thai/Western",
          "desc": "Main resort restaurant on the sand",
          "lat": 7.3127,
          "lng": 99.2564,
          "website": null
        },
        {
          "id": "kradan_sevenseas",
          "name": "The Sevenseas Restaurant",
          "cuisine": "Thai/Seafood",
          "desc": "Upscale resort dining",
          "lat": 7.3098,
          "lng": 99.251,
          "website": null
        },
        {
          "id": "kradan_mali",
          "name": "Mali Resort Restaurant",
          "cuisine": "Western",
          "desc": "Best burgers & pizza on the island",
          "lat": 7.312,
          "lng": 99.253,
          "website": null
        },
        {
          "id": "kradan_kalume",
          "name": "Kalume Restaurant",
          "cuisine": "Italian",
          "desc": "Outstanding Italian with ocean views",
          "lat": 7.308,
          "lng": 99.252,
          "website": null
        },
        {
          "id": "kradan_reef",
          "name": "Reef Resort Restaurant",
          "cuisine": "Thai/Western",
          "desc": "Beachfront dining under the stars",
          "lat": 7.315,
          "lng": 99.256,
          "website": "https://www.reefresortkradan.com/"
        }
      ],
      "lunch": [
        {
          "id": "kradan_nationalpark",
          "name": "National Park Restaurant",
          "cuisine": "Thai",
          "desc": "Budget-friendly Thai classics",
          "lat": 7.316,
          "lng": 99.257,
          "website": null
        },
        {
          "id": "kradan_beachbar",
          "name": "Paradise Beach Bar",
          "cuisine": "Cafe",
          "desc": "Smoothies & snacks on the sand",
          "lat": 7.3145,
          "lng": 99.255,
          "website": null
        }
      ],
      "bars": [
        {
          "id": "kradan_sevenseas_bar",
          "name": "Sevenseas Bar",
          "type": "Resort Bar",
          "desc": "Upscale resort bar with sunset views",
          "lat": 7.3098,
          "lng": 99.251,
          "website": "https://www.google.com/search?q=Sevenseas+Resort+Koh+Kradan"
        },
        {
          "id": "kradan_reef_bar",
          "name": "Reef Resort Beach Bar",
          "type": "Beach Bar",
          "desc": "Relaxed beachfront drinks under the stars",
          "lat": 7.315,
          "lng": 99.256,
          "website": "https://www.reefresortkradan.com/"
        }
      ],
      "diving": [
        {
          "id": "kradan_paradise_reef",
          "name": "Paradise Beach Reef",
          "depth": "2-8m",
          "desc": "Staghorn corals, reef fish, octopus - snorkel from beach",
          "lat": 7.3195,
          "lng": 99.258
        },
        {
          "id": "kradan_kohrok",
          "name": "Koh Rok",
          "depth": "5-25m",
          "desc": "Pristine reefs, manta rays, whale sharks in season",
          "lat": 7.208,
          "lng": 99.058
        }
      ],
      "summary": "The 'Maldives of Thailand' - a tiny car-free island with powder white sand and turquoise water. Just a few resorts, no village, no ATMs. Snorkel straight off Paradise Beach to see incredible coral. Day trips to Emerald Cave on nearby Koh Mook."
    },
    {
      "location": "koh_lanta",
      "hotel": "Relax Bay Beach Resort",
      "hotelLat": 7.5389,
      "hotelLng": 99.0353,
      "start": "2026-03-23",
      "end": "2026-03-27",
      "nights": 4,
      "arrival": "midday",
      "arrivalTime": "12:00",
      "departure": "late morning",
      "departureTime": "11:00",
      "weather": {
        "high": 33,
        "low": 26,
        "condition": "sunny",
        "rain": 12,
        "humidity": 74,
        "desc": "Ideal beach weather"
      },
      "attractions": [
        {
          "id": "lanta_oldtown",
          "name": "Old Town Lanta",
          "type": "cultural",
          "desc": "Historic sea gypsy stilt houses & cafes",
          "lat": 7.533,
          "lng": 99.0865,
          "website": "https://www.google.com/maps/search/Old+Town+Lanta+Koh+Lanta"
        },
        {
          "id": "lanta_nationalpark",
          "name": "Mu Ko Lanta National Park",
          "type": "nature",
          "desc": "Lighthouse, beaches & jungle trails",
          "lat": 7.47,
          "lng": 99.0985,
          "website": "https://www.thainationalparks.com/mu-ko-lanta-national-park"
        },
        {
          "id": "lanta_longbeach",
          "name": "Long Beach (Phra Ae)",
          "type": "beach",
          "desc": "Main beach strip with bars & restaurants",
          "lat": 7.575,
          "lng": 99.028,
          "website": "https://www.google.com/maps/search/Long+Beach+Phra+Ae+Koh+Lanta"
        },
        {
          "id": "lanta_kantiang",
          "name": "Kantiang Bay",
          "type": "beach",
          "desc": "Stunning secluded bay with calm waters",
          "lat": 7.492,
          "lng": 99.031,
          "website": "https://www.google.com/maps/search/Kantiang+Bay+Koh+Lanta"
        },
        {
          "id": "lanta_caves",
          "name": "Khao Mai Kaew Caves",
          "type": "nature",
          "desc": "Explore stalactite caves in the jungle",
          "lat": 7.52,
          "lng": 99.06,
          "website": "https://www.google.com/maps/search/Khao+Mai+Kaew+Caves+Koh+Lanta"
        }
      ],
      "dinner": [
        {
          "id": "lanta_timeforlime",
          "name": "Time for Lime",
          "cuisine": "Thai",
          "desc": "Cooking school restaurant, creative Thai",
          "lat": 7.6428,
          "lng": 99.0315,
          "website": "https://timeforlime.net/"
        },
        {
          "id": "lanta_redsnapper",
          "name": "Red Snapper",
          "cuisine": "Seafood",
          "desc": "Fresh seafood with island views",
          "lat": 7.581,
          "lng": 99.031,
          "website": "https://www.google.com/search?q=Red+Snapper+Restaurant+Koh+Lanta"
        },
        {
          "id": "lanta_yawee",
          "name": "Yawee Restaurant",
          "cuisine": "Thai",
          "desc": "Famous family-run spot, amazing wings",
          "lat": 7.56,
          "lng": 99.042,
          "website": null
        },
        {
          "id": "lanta_whereelse",
          "name": "Where Else",
          "cuisine": "Thai/Western",
          "desc": "Treehouse dining with hammocks",
          "lat": 7.635,
          "lng": 99.033,
          "website": null
        },
        {
          "id": "lanta_funkyfish",
          "name": "Funky Fish",
          "cuisine": "Seafood",
          "desc": "Beachfront with live reggae music",
          "lat": 7.575,
          "lng": 99.03,
          "website": null
        }
      ],
      "lunch": [
        {
          "id": "lanta_drunkensailors",
          "name": "Drunken Sailors Coffee",
          "cuisine": "Cafe",
          "desc": "Best coffee on the island",
          "lat": 7.4912,
          "lng": 99.034,
          "website": null
        },
        {
          "id": "lanta_kinburger",
          "name": "Kinburger",
          "cuisine": "Western",
          "desc": "Great burgers at local prices",
          "lat": 7.58,
          "lng": 99.0315,
          "website": "https://www.instagram.com/kinburgerlanta/"
        },
        {
          "id": "lanta_pattys",
          "name": "Patty's Secret Garden",
          "cuisine": "Thai/Western",
          "desc": "Beachfront cafe with sunset views",
          "lat": 7.578,
          "lng": 99.0295,
          "website": null
        },
        {
          "id": "lanta_nightmarket",
          "name": "Lanta Night Market",
          "cuisine": "Street Food",
          "desc": "Authentic Thai street food stalls",
          "lat": 7.648,
          "lng": 99.04,
          "website": null
        },
        {
          "id": "lanta_tamarind",
          "name": "Tamarind",
          "cuisine": "Thai",
          "desc": "Excellent papaya salad & green curry",
          "lat": 7.582,
          "lng": 99.032,
          "website": null
        }
      ],
      "bars": [
        {
          "id": "lanta_pangea",
          "name": "Pangea Beach Bar",
          "type": "Beach Bar",
          "desc": "Best sunset spot with live reggae and fire shows",
          "lat": 7.578,
          "lng": 99.0285,
          "website": "https://www.google.com/search?q=Pangea+Beach+Bar+Koh+Lanta"
        },
        {
          "id": "lanta_opium",
          "name": "Opium Bar",
          "type": "Beach Bar",
          "desc": "Bohemian beachfront bar with hookah and cocktails",
          "lat": 7.576,
          "lng": 99.029,
          "website": "https://www.google.com/search?q=Opium+Bar+Koh+Lanta"
        },
        {
          "id": "lanta_irishembassy",
          "name": "The Irish Embassy",
          "type": "Pub",
          "desc": "Proper pub with pool tables, sports TV, and Guinness",
          "lat": 7.647,
          "lng": 99.0395,
          "website": "https://www.google.com/search?q=Irish+Embassy+Koh+Lanta"
        },
        {
          "id": "lanta_ting",
          "name": "Ting Rai Bay Bar",
          "type": "Beach Bar",
          "desc": "Chilled bar at stunning Kantiang Bay",
          "lat": 7.4925,
          "lng": 99.0305,
          "website": "https://www.google.com/search?q=Ting+Rai+Bay+Koh+Lanta"
        },
        {
          "id": "lanta_freedom",
          "name": "Freedom Bar",
          "type": "Beach Bar",
          "desc": "Rasta vibes, cheap buckets, beach bonfire nights",
          "lat": 7.58,
          "lng": 99.028,
          "website": "https://www.google.com/search?q=Freedom+Bar+Koh+Lanta"
        }
      ],
      "diving": [
        {
          "id": "lanta_kohhaa",
          "name": "Koh Haa Lagoon",
          "depth": "5-30m",
          "desc": "Cathedral cave, pristine corals, seahorses & ghost pipefish",
          "lat": 7.429,
          "lng": 98.897
        },
        {
          "id": "lanta_bidanok",
          "name": "Koh Bida Nok",
          "depth": "8-28m",
          "desc": "Leopard sharks, stunning wall dive near Phi Phi",
          "lat": 7.6534,
          "lng": 98.7638
        },
        {
          "id": "lanta_hindaeng",
          "name": "Hin Daeng",
          "depth": "10-50m",
          "desc": "Red rock, manta rays, whale sharks, world-class site",
          "lat": 7.1461,
          "lng": 98.824
        },
        {
          "id": "lanta_hinmuang",
          "name": "Hin Muang",
          "depth": "8-60m",
          "desc": "Purple rock, deepest wall in Thailand, big pelagics",
          "lat": 7.1594,
          "lng": 98.8313
        }
      ],
      "summary": "The largest island on the trip with proper roads, scooter rentals, and a chill reggae vibe. Long Beach has the bars and restaurants, Old Town has historic stilt houses and cafes. Best diving access to Hin Daeng/Hin Muang - Thailand's top sites."
    },
    {
      "location": "bangkok",
      "hotel": "Casa Vimaya Riverside",
      "hotelLat": 13.758,
      "hotelLng": 100.4853,
      "start": "2026-03-27",
      "end": "2026-03-28",
      "nights": 1,
      "arrival": "evening",
      "arrivalTime": "17:15",
      "departure": "evening",
      "departureTime": "20:05",
      "weather": {
        "high": 35,
        "low": 27,
        "condition": "sunny",
        "rain": 8,
        "humidity": 62,
        "desc": "End of dry season, warm evenings"
      },
      "attractions": [
        {
          "id": "bkk2_iconsiam",
          "name": "Icon Siam",
          "type": "activity",
          "desc": "Luxury mall with indoor floating market",
          "lat": 13.7267,
          "lng": 100.5097,
          "website": "https://www.iconsiam.com/"
        },
        {
          "id": "bkk2_chinatown",
          "name": "Chinatown (Yaowarat)",
          "type": "cultural",
          "desc": "Street food paradise after dark",
          "lat": 13.7388,
          "lng": 100.5093,
          "website": "https://www.google.com/maps/search/Yaowarat+Chinatown+Bangkok"
        },
        {
          "id": "bkk2_asiatique",
          "name": "Asiatique The Riverfront",
          "type": "activity",
          "desc": "Night market & entertainment complex",
          "lat": 13.705,
          "lng": 100.501,
          "website": "https://www.asiatiquethailand.com/"
        },
        {
          "id": "bkk2_watpho",
          "name": "Wat Pho",
          "type": "cultural",
          "desc": "Giant reclining Buddha & massage school",
          "lat": 13.7465,
          "lng": 100.493,
          "website": "https://www.watpho.com/"
        },
        {
          "id": "bkk2_rivercruise",
          "name": "Chao Phraya River Cruise",
          "type": "activity",
          "desc": "Evening dinner cruise past lit temples",
          "lat": 13.74,
          "lng": 100.5,
          "website": "https://www.google.com/maps/search/Chao+Phraya+River+Cruise+Bangkok"
        }
      ],
      "dinner": [
        {
          "id": "bkk2_deck",
          "name": "The Deck by Arun Residence",
          "cuisine": "Thai/Western",
          "desc": "Wat Arun views, rooftop dining",
          "lat": 13.7448,
          "lng": 100.4898,
          "website": "https://www.arunresidence.com/"
        },
        {
          "id": "bkk2_sirocco",
          "name": "Sirocco at Lebua",
          "cuisine": "Mediterranean",
          "desc": "Famous sky bar from Hangover II",
          "lat": 13.7218,
          "lng": 100.5153,
          "website": "https://lebua.com/restaurants/sirocco/"
        },
        {
          "id": "bkk2_err",
          "name": "Err Urban Rustic Thai",
          "cuisine": "Thai",
          "desc": "Hip Thai street food elevated",
          "lat": 13.7468,
          "lng": 100.4935,
          "website": "https://errurbanrusticthai.co.th/"
        },
        {
          "id": "bkk2_salarattanakosin",
          "name": "Sala Rattanakosin",
          "cuisine": "Thai",
          "desc": "Rooftop dining with Wat Arun views",
          "lat": 13.7455,
          "lng": 100.4905,
          "website": "https://www.google.com/search?q=Sala+Rattanakosin+Bangkok+restaurant"
        },
        {
          "id": "bkk2_supanniga",
          "name": "Supanniga Eating Room",
          "cuisine": "Thai",
          "desc": "Eastern Thai cuisine by the river",
          "lat": 13.746,
          "lng": 100.4925,
          "website": "https://www.supannigaeatingroom.com/"
        }
      ],
      "lunch": [
        {
          "id": "bkk2_yaowarat",
          "name": "Yaowarat Street Food",
          "cuisine": "Chinese/Thai",
          "desc": "Chinatown food crawl",
          "lat": 13.7388,
          "lng": 100.5093,
          "website": null
        },
        {
          "id": "bkk2_talmai",
          "name": "Talat Mai Market",
          "cuisine": "Market",
          "desc": "200-year-old Chinatown market",
          "lat": 13.7395,
          "lng": 100.5075,
          "website": null
        },
        {
          "id": "bkk2_pakklongtalat",
          "name": "Pak Khlong Talat",
          "cuisine": "Market",
          "desc": "Famous flower market with food stalls",
          "lat": 13.7405,
          "lng": 100.497,
          "website": null
        },
        {
          "id": "bkk2_thaprachan",
          "name": "Tha Prachan Food Stalls",
          "cuisine": "Street Food",
          "desc": "University area street food near Grand Palace",
          "lat": 13.7565,
          "lng": 100.4915,
          "website": null
        },
        {
          "id": "bkk2_bluewhalecafe",
          "name": "Blue Whale Cafe",
          "cuisine": "Cafe",
          "desc": "Instagrammable blue lattes in old town",
          "lat": 13.747,
          "lng": 100.492,
          "website": "https://www.instagram.com/bluewhalebkk/"
        }
      ],
      "bars": [
        {
          "id": "bkk2_skybar",
          "name": "Sky Bar at Lebua",
          "type": "Rooftop",
          "desc": "The Hangover II bar - iconic Bangkok skyline views",
          "lat": 13.7218,
          "lng": 100.5153,
          "website": "https://lebua.com/restaurants/sky-bar/"
        },
        {
          "id": "bkk2_tep",
          "name": "Tep Bar",
          "type": "Thai Bar",
          "desc": "Traditional Thai spirits & live folk music in Chinatown",
          "lat": 13.7395,
          "lng": 100.5095,
          "website": "https://www.google.com/search?q=Tep+Bar+Bangkok"
        },
        {
          "id": "bkk2_teens",
          "name": "Teens of Thailand",
          "type": "Cocktail Bar",
          "desc": "Award-winning gin bar in a Chinatown shophouse",
          "lat": 13.7392,
          "lng": 100.5098,
          "website": "https://www.google.com/search?q=Teens+of+Thailand+Bar+Bangkok"
        },
        {
          "id": "bkk2_tropic",
          "name": "Tropic City",
          "type": "Tiki Bar",
          "desc": "Tropical tiki cocktails in Chinatown alley",
          "lat": 13.739,
          "lng": 100.51,
          "website": "https://www.google.com/search?q=Tropic+City+Bar+Bangkok"
        },
        {
          "id": "bkk2_ama",
          "name": "AMA",
          "type": "Wine Bar",
          "desc": "Natural wines & small plates in hidden old town location",
          "lat": 13.7388,
          "lng": 100.5092,
          "website": "https://www.google.com/search?q=AMA+Wine+Bar+Bangkok"
        }
      ],
      "diving": null,
      "summary": "Riverside boutique hotel in the historic Rattanakosin area, a boat ride from Wat Arun and the Grand Palace. Perfect final night location - sunset drinks on the river, Chinatown street food nearby, then straight to the airport for the flight home."
    }
  ]
};

        const locations = data.locations;
        const route = data.route;
        const stays = data.stays;

        const map = L.map('map').setView([7.5, 99.5], 8);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        function createMarker(type) {
            return L.divIcon({
                className: 'custom-marker ' + type,
                iconSize: [16, 16],
                iconAnchor: [8, 8],
                popupAnchor: [0, -12]
            });
        }

        function createPoiMarker(type, icon) {
            return L.divIcon({
                className: 'poi-marker ' + type,
                html: icon,
                iconSize: [24, 24],
                iconAnchor: [12, 12],
                popupAnchor: [0, -14]
            });
        }

        const poiLayer = L.layerGroup().addTo(map);

        function clearPoiMarkers() {
            poiLayer.clearLayers();
        }

        function showPoiMarkers(stay, category) {
            clearPoiMarkers();
            let items, markerType, defaultIcon;
            const typeIcons = { cultural: 'üèõÔ∏è', activity: 'üéØ', beach: 'üèñÔ∏è', nature: 'üåø', wildlife: 'ü¶≠', nightlife: 'üåô' };

            if (category === 'attractions') {
                items = stay.attractions;
                markerType = 'attraction';
            } else if (category === 'dinner') {
                items = stay.dinner;
                markerType = 'dinner';
                defaultIcon = 'üçΩÔ∏è';
            } else if (category === 'lunch') {
                items = stay.lunch;
                markerType = 'lunch';
                defaultIcon = 'ü•ó';
            } else if (category === 'bars') {
                items = stay.bars || [];
                markerType = 'bars';
                defaultIcon = 'üç∏';
            } else if (category === 'diving') {
                items = stay.diving || [];
                markerType = 'diving';
                defaultIcon = 'ü§ø';
            }

            if (!items || items.length === 0) return;

            const bounds = [];
            items.forEach((item) => {
                if (!item.lat || !item.lng) return;
                const icon = category === 'attractions' ? (typeIcons[item.type] || 'üìç') : defaultIcon;
                const marker = L.marker([item.lat, item.lng], { icon: createPoiMarker(markerType, icon) });

                let popupContent = `<div class="poi-popup"><div class="popup-title">${item.name}</div>`;
                if (category === 'attractions') {
                    popupContent += `<div class="popup-type">${item.type}</div>`;
                } else if (category === 'diving') {
                    popupContent += `<div class="popup-type">${item.depth}</div>`;
                } else if (category === 'bars') {
                    popupContent += `<div class="popup-type">${item.type}</div>`;
                } else {
                    popupContent += `<div class="popup-type">${item.cuisine}</div>`;
                }
                popupContent += `<div class="popup-desc">${item.desc}</div>`;
                if (item.website) {
                    popupContent += `<a href="${item.website}" target="_blank" rel="noopener" class="popup-link">Visit website ‚Üó</a>`;
                }
                popupContent += `</div>`;

                marker.bindPopup(popupContent);
                marker.addTo(poiLayer);
                bounds.push([item.lat, item.lng]);
            });

            if (bounds.length > 0) {
                map.fitBounds(bounds, { padding: [50, 50], maxZoom: 14 });
            }
        }

        // Add location markers
        const markers = {};
        Object.entries(locations).forEach(([key, loc]) => {
            const marker = L.marker([loc.lat, loc.lng], { icon: createMarker(loc.type) }).addTo(map);
            const stay = stays.find(s => s.location === key);
            let popupContent = `<div class="popup-title">${loc.name}</div>`;
            if (stay) {
                popupContent += `<div class="popup-subtitle">${stay.hotel}<br>${stay.nights} night${stay.nights > 1 ? 's' : ''}</div>`;
            }
            marker.bindPopup(popupContent);
            markers[key] = marker;
        });

        // Draw route lines
        const lineColors = { flight: '#e07b39', ferry: '#0891b2', transfer: '#c9a227' };
        route.forEach(segment => {
            const from = locations[segment.from];
            const to = locations[segment.to];
            if (from && to) {
                L.polyline([[from.lat, from.lng], [to.lat, to.lng]], {
                    color: lineColors[segment.type] || '#888',
                    weight: 3,
                    opacity: 0.8,
                    dashArray: segment.type === 'flight' ? '10, 10' : null
                }).addTo(map);
            }
        });

        // Render stays
        const staysList = document.getElementById('stays-list');
        stays.forEach((stay) => {
            const loc = locations[stay.location];
            const card = document.createElement('div');
            card.className = 'stay-card';

            const typeIcons = { cultural: 'üèõÔ∏è', activity: 'üéØ', beach: 'üèñÔ∏è', nature: 'üåø', wildlife: 'ü¶≠', nightlife: 'üåô' };
            const weatherIcons = { sunny: '‚òÄÔ∏è', partly_cloudy: '‚õÖ', cloudy: '‚òÅÔ∏è', rain: 'üåßÔ∏è', storm: '‚õàÔ∏è' };

            const attractionsHtml = stay.attractions.map(a => `
                <div class="attraction-item" data-id="${a.id}" data-category="attractions">
                    <div class="attraction-icon">${typeIcons[a.type] || 'üìç'}</div>
                    <div class="attraction-info">
                        <div class="attraction-name">${a.website ? `<a href="${a.website}" target="_blank" rel="noopener" title="View on map">${a.name} ‚Üó</a>` : a.name}</div>
                        <div class="attraction-desc">${a.desc}</div>
                    </div>
                    <button class="fav-btn" data-id="${a.id}" data-category="attractions" title="Add to favorites">‚ô°</button>
                </div>
            `).join('');

            const dinnerHtml = stay.dinner.map(d => `
                <div class="food-item" data-id="${d.id}" data-category="dinner">
                    <div class="food-icon dinner">üçΩÔ∏è</div>
                    <div class="food-info">
                        <div class="food-name">${d.website ? `<a href="${d.website}" target="_blank" rel="noopener" title="Visit website">${d.name} ‚Üó</a>` : d.name}</div>
                        <div><span class="food-cuisine">${d.cuisine}</span></div>
                        <div class="food-desc">${d.desc}</div>
                    </div>
                    <button class="fav-btn" data-id="${d.id}" data-category="dinner" title="Add to favorites">‚ô°</button>
                </div>
            `).join('');

            const lunchHtml = stay.lunch.map(l => `
                <div class="food-item" data-id="${l.id}" data-category="lunch">
                    <div class="food-icon lunch">ü•ó</div>
                    <div class="food-info">
                        <div class="food-name">${l.website ? `<a href="${l.website}" target="_blank" rel="noopener" title="Visit website">${l.name} ‚Üó</a>` : l.name}</div>
                        <div><span class="food-cuisine">${l.cuisine}</span></div>
                        <div class="food-desc">${l.desc}</div>
                    </div>
                    <button class="fav-btn" data-id="${l.id}" data-category="lunch" title="Add to favorites">‚ô°</button>
                </div>
            `).join('');

            const barsHtml = stay.bars ? stay.bars.map(b => `
                <div class="food-item" data-id="${b.id}" data-category="bars">
                    <div class="food-icon bar">üç∏</div>
                    <div class="food-info">
                        <div class="food-name">${b.website ? `<a href="${b.website}" target="_blank" rel="noopener" title="Visit website">${b.name} ‚Üó</a>` : b.name}</div>
                        <div><span class="food-cuisine" style="color:#9b59b6;background:rgba(155,89,182,0.1)">${b.type}</span></div>
                        <div class="food-desc">${b.desc}</div>
                    </div>
                    <button class="fav-btn" data-id="${b.id}" data-category="bars" title="Add to favorites">‚ô°</button>
                </div>
            `).join('') : '';

            const divingHtml = stay.diving ? stay.diving.map(d => `
                <div class="dive-item" data-id="${d.id}" data-category="diving">
                    <div class="dive-icon">ü§ø</div>
                    <div class="dive-info">
                        <div class="dive-name">${d.name}</div>
                        <div><span class="dive-depth">${d.depth}</span></div>
                        <div class="dive-desc">${d.desc}</div>
                    </div>
                    <button class="fav-btn" data-id="${d.id}" data-category="diving" title="Add to favorites">‚ô°</button>
                </div>
            `).join('') : '';

            const weatherHtml = stay.weather ? `
                <div class="weather">
                    <div class="weather-icon">${weatherIcons[stay.weather.condition] || '‚òÄÔ∏è'}</div>
                    <div class="weather-temps">
                        <span class="weather-high">${stay.weather.high}¬∞C</span>
                        <span class="weather-low">${stay.weather.low}¬∞C</span>
                    </div>
                    <div class="weather-details">
                        <span class="weather-rain">üíß ${stay.weather.rain}% rain</span>
                        <span class="weather-desc">${stay.weather.desc}</span>
                    </div>
                </div>
            ` : '';

            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });
            };

            card.innerHTML = `
                <div class="location">${loc.name}</div>
                <div class="hotel">${stay.hotel}</div>
                <div class="dates">
                    ${formatDate(stay.start)} - ${formatDate(stay.end)}
                    <span class="nights">${stay.nights} night${stay.nights > 1 ? 's' : ''}</span>
                </div>
                <div class="times">
                    <div class="time-block">
                        <span class="time-label">Arrive</span>
                        <span class="time-value">${stay.arrival} <span class="time-exact">${stay.arrivalTime}</span></span>
                    </div>
                    <div class="time-block">
                        <span class="time-label">Leave</span>
                        <span class="time-value departure">${stay.departure} <span class="time-exact">${stay.departureTime}</span></span>
                    </div>
                </div>
                ${weatherHtml}
                ${stay.summary ? `<div class="area-summary">${stay.summary}</div>` : ''}
                <button class="expand-btn" data-panel="attractions">
                    <span>üéØ Things to do</span>
                    <span class="arrow">‚ñº</span>
                </button>
                <div class="panel attractions-panel" data-panel="attractions">
                    ${attractionsHtml}
                </div>
                <div class="expand-buttons">
                    <button class="expand-btn dinner" data-panel="dinner">
                        <span>üçΩÔ∏è Dinner</span>
                        <span class="arrow">‚ñº</span>
                    </button>
                    <button class="expand-btn lunch" data-panel="lunch">
                        <span>ü•ó Casual</span>
                        <span class="arrow">‚ñº</span>
                    </button>
                    ${stay.bars && stay.bars.length ? `<button class="expand-btn bars" data-panel="bars">
                        <span>üç∏ Bars</span>
                        <span class="arrow">‚ñº</span>
                    </button>` : ''}
                    ${stay.diving ? `<button class="expand-btn diving" data-panel="diving">
                        <span>ü§ø Diving</span>
                        <span class="arrow">‚ñº</span>
                    </button>` : ''}
                </div>
                <div class="panel dinner-panel" data-panel="dinner">
                    ${dinnerHtml}
                </div>
                <div class="panel lunch-panel" data-panel="lunch">
                    ${lunchHtml}
                </div>
                ${stay.bars && stay.bars.length ? `<div class="panel bars-panel" data-panel="bars">
                    ${barsHtml}
                </div>` : ''}
                ${stay.diving ? `<div class="panel diving-panel" data-panel="diving">
                    ${divingHtml}
                </div>` : ''}
            `;

            card.addEventListener('click', (e) => {
                if (!e.target.closest('.expand-btn') && !e.target.closest('.panel')) {
                    map.setView([stay.hotelLat || loc.lat, stay.hotelLng || loc.lng], 13);
                    markers[stay.location]?.openPopup();
                    document.querySelectorAll('.stay-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                }
            });

            card.querySelectorAll('.expand-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const panelType = btn.dataset.panel;
                    const panel = card.querySelector(`.panel[data-panel="${panelType}"]`);
                    const isOpen = panel.classList.contains('open');

                    card.querySelectorAll('.panel').forEach(p => p.classList.remove('open'));
                    card.querySelectorAll('.expand-btn').forEach(b => b.classList.remove('active'));
                    clearPoiMarkers();

                    if (!isOpen) {
                        panel.classList.add('open');
                        btn.classList.add('active');
                        showPoiMarkers(stay, panelType);
                    }
                });
            });

            staysList.appendChild(card);
        });

        // Render transfers
        const transfersList = document.getElementById('transfers-list');
        const icons = { flight: '‚úàÔ∏è', ferry: '‚õ¥Ô∏è', transfer: 'üöê' };
        route.forEach(segment => {
            const from = locations[segment.from];
            const to = locations[segment.to];
            const card = document.createElement('div');
            card.className = 'transfer-card';
            const formatDate = (dateStr) => {
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });
            };
            card.innerHTML = `
                <span class="transfer-icon">${icons[segment.type] || 'üöó'}</span>
                <div class="transfer-details">
                    <div class="transfer-route">${from.name} ‚Üí ${to.name}</div>
                    <div class="transfer-type">${segment.label} ¬∑ ${formatDate(segment.date)}</div>
                </div>
            `;
            transfersList.appendChild(card);
        });

        // Fit map to Thailand
        map.fitBounds([[6.0, 98.5], [14.5, 101.5]]);

        // ========== JSONBIN CONFIG ==========
        const JSONBIN_ID = '69a336d9ae596e708f52ec85';
        const JSONBIN_KEY = '$2a$10$wCuuZmAY7T.IwQtMq8rkqOt1s3nxZJvnyO2ZIGfdXjzwVV9Q3Eaxa';

        // ========== FAVORITES SYSTEM ==========
        let favorites = {};
        let allFavorites = {};
        let currentUser = null;

        async function loadFavorites(username) {
            currentUser = username;
            // Try cloud first
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_ID}/latest`, {
                    headers: { 'X-Master-Key': JSONBIN_KEY }
                });
                const data = await res.json();
                allFavorites = data.record || {};
                favorites = allFavorites[username] || {};
                // Cache locally
                localStorage.setItem('holidaze_favorites_cache', JSON.stringify(allFavorites));
            } catch (e) {
                // Fallback to local cache
                allFavorites = JSON.parse(localStorage.getItem('holidaze_favorites_cache') || '{}');
                favorites = allFavorites[username] || {};
                console.warn('Using cached favorites (offline mode)');
            }
            updateAllFavoriteUI();
        }

        async function toggleFavorite(id, category) {
            if (!currentUser) return;
            if (!favorites[category]) favorites[category] = [];
            const idx = favorites[category].indexOf(id);
            if (idx > -1) {
                favorites[category].splice(idx, 1);
            } else {
                favorites[category].push(id);
            }

            // Update cloud
            allFavorites[currentUser] = favorites;
            localStorage.setItem('holidaze_favorites_cache', JSON.stringify(allFavorites));

            try {
                await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_KEY
                    },
                    body: JSON.stringify(allFavorites)
                });
            } catch (e) {
                console.warn('Failed to sync favorites to cloud');
            }

            updateFavoriteUI(id, category);
            updateStayCardFavoriteState();
        }

        function isFavorited(id, category) {
            return favorites[category] && favorites[category].includes(id);
        }

        function updateFavoriteUI(id, category) {
            const item = document.querySelector(`[data-id="${id}"][data-category="${category}"]`);
            if (!item) return;
            const btn = item.querySelector('.fav-btn') || item;
            if (isFavorited(id, category)) {
                item.classList.add('favorited');
                if (btn.classList.contains('fav-btn')) {
                    btn.classList.add('favorited');
                    btn.textContent = '‚ô•';
                }
            } else {
                item.classList.remove('favorited');
                if (btn.classList.contains('fav-btn')) {
                    btn.classList.remove('favorited');
                    btn.textContent = '‚ô°';
                }
            }
        }

        function updateAllFavoriteUI() {
            document.querySelectorAll('.fav-btn').forEach(btn => {
                const id = btn.dataset.id;
                const category = btn.dataset.category;
                updateFavoriteUI(id, category);
            });
            updateStayCardFavoriteState();
            // Update favorites count badge
            const totalCount = Object.values(favorites).reduce((sum, arr) => sum + arr.length, 0);
            const favMapBtn = document.getElementById('favMapBtn');
            if (totalCount > 0) {
                favMapBtn.innerHTML = '‚ô•<span class="fav-count">' + totalCount + '</span>';
            } else {
                favMapBtn.innerHTML = '‚ô°';
            }
        }

        function updateStayCardFavoriteState() {
            // Mark stay cards that have at least one favorite
            document.querySelectorAll('.stay-card').forEach(card => {
                const hasFav = card.querySelector('.favorited') !== null;
                card.classList.toggle('has-favorites', hasFav);
            });
        }

        // ========== LOGIN SYSTEM ==========
        const allowedUsers = ['callum', 'laura', 'andy', 'andrew', 'jude', 'judith'];
        const loginPage = document.getElementById('loginPage');
        const mainApp = document.getElementById('mainApp');
        const loginForm = document.getElementById('loginForm');
        const usernameInput = document.getElementById('usernameInput');
        const loginError = document.getElementById('loginError');
        const userNameDisplay = document.getElementById('userName');
        const logoutBtn = document.getElementById('logoutBtn');

        function showApp(username) {
            const displayName = username.charAt(0).toUpperCase() + username.slice(1);
            userNameDisplay.textContent = displayName;
            loginPage.style.display = 'none';
            mainApp.style.display = 'flex';
            // Load user's favorites from cloud
            loadFavorites(username);
            // Close favorites panel
            document.getElementById('favPanel').classList.remove('open');
            document.getElementById('favMapBtn').classList.remove('active');
            // Trigger map resize and fit to all stay locations
            setTimeout(() => {
                map.invalidateSize();
                // Collect all hotel coordinates to fit bounds
                const bounds = stays.map(stay => [stay.hotelLat, stay.hotelLng]);
                if (bounds.length > 0) {
                    map.fitBounds(bounds, { padding: [40, 40] });
                }
            }, 100);
        }

        function showLogin() {
            loginPage.style.display = 'flex';
            mainApp.style.display = 'none';
            usernameInput.value = '';
            loginError.classList.remove('show');
        }

        function login(username) {
            const normalized = username.toLowerCase().trim();
            if (allowedUsers.includes(normalized)) {
                showApp(normalized);
                return true;
            }
            return false;
        }

        function logout() {
            showLogin();
        }

        // Always start at login
        showLogin();

        // Login form submit
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            if (!login(usernameInput.value)) {
                loginError.classList.add('show');
                usernameInput.focus();
            }
        });

        // Avatar click to login
        document.querySelectorAll('.login-avatar').forEach(avatar => {
            avatar.addEventListener('click', () => {
                login(avatar.dataset.name);
            });
        });

        // Logout button
        logoutBtn.addEventListener('click', logout);

        // Clear error on input
        usernameInput.addEventListener('input', () => {
            loginError.classList.remove('show');
        });

        // ========== FAVORITES EVENT HANDLERS ==========
        const favMapBtn = document.getElementById('favMapBtn');
        const favPanel = document.getElementById('favPanel');
        const favPanelContent = document.getElementById('favPanelContent');
        const favCount = document.getElementById('favCount');

        const categoryIcons = { attractions: 'üìç', dinner: 'üçΩÔ∏è', lunch: 'ü•ó', bars: 'üç∏', diving: 'ü§ø' };
        const categoryLabels = { attractions: 'Things to Do', dinner: 'Dinner', lunch: 'Casual Eats', bars: 'Bars', diving: 'Diving' };

        function renderFavoritesPanel() {
            const allItems = [];
            // Collect all favorited items with their details
            Object.entries(favorites).forEach(([category, ids]) => {
                ids.forEach(id => {
                    // Find the item in stays data
                    for (const stay of stays) {
                        const categoryKey = category === 'attractions' ? 'attractions' : category;
                        const items = stay[categoryKey] || [];
                        const item = items.find(i => i.id === id);
                        if (item) {
                            allItems.push({ ...item, category, location: stay.location, stay });
                            break;
                        }
                    }
                });
            });

            // Update count badge
            const totalCount = allItems.length;
            if (totalCount > 0) {
                favCount.textContent = totalCount;
                favCount.style.display = 'flex';
                favMapBtn.innerHTML = '‚ô•<span class="fav-count" id="favCount">' + totalCount + '</span>';
            } else {
                favMapBtn.innerHTML = '‚ô°';
            }

            // Render panel content
            if (allItems.length === 0) {
                favPanelContent.innerHTML = '<div class="fav-panel-empty">No favorites yet.<br>Click the heart on any item to add it here.</div>';
                return;
            }

            // Group by category
            const grouped = {};
            allItems.forEach(item => {
                if (!grouped[item.category]) grouped[item.category] = [];
                grouped[item.category].push(item);
            });

            let html = '';
            Object.entries(grouped).forEach(([category, items]) => {
                html += `<div class="fav-panel-category">${categoryLabels[category] || category}</div>`;
                items.forEach(item => {
                    const loc = locations[item.location];
                    html += `
                        <div class="fav-panel-item" data-id="${item.id}" data-category="${category}" data-lat="${item.lat}" data-lng="${item.lng}">
                            <div class="fav-icon ${category}">${categoryIcons[category]}</div>
                            <div class="fav-name">${item.name}</div>
                            <div class="fav-location">${loc?.name || ''}</div>
                            <div class="fav-remove" data-id="${item.id}" data-category="${category}">√ó</div>
                        </div>
                    `;
                });
            });
            favPanelContent.innerHTML = html;
        }

        // Toggle favorites panel
        favMapBtn.addEventListener('click', () => {
            const isOpen = favPanel.classList.toggle('open');
            favMapBtn.classList.toggle('active', isOpen);
            if (isOpen) renderFavoritesPanel();
        });

        // Click on favorite item to navigate
        favPanelContent.addEventListener('click', (e) => {
            const removeBtn = e.target.closest('.fav-remove');
            if (removeBtn) {
                e.stopPropagation();
                toggleFavorite(removeBtn.dataset.id, removeBtn.dataset.category);
                renderFavoritesPanel();
                return;
            }
            const item = e.target.closest('.fav-panel-item');
            if (item && item.dataset.lat && item.dataset.lng) {
                map.setView([parseFloat(item.dataset.lat), parseFloat(item.dataset.lng)], 15);
                favPanel.classList.remove('open');
                favMapBtn.classList.remove('active');
            }
        });

        // Delegate click handler for favorite buttons in sidebar
        document.getElementById('stays-list').addEventListener('click', (e) => {
            const favBtn = e.target.closest('.fav-btn');
            if (favBtn) {
                e.stopPropagation();
                e.preventDefault();
                const id = favBtn.dataset.id;
                const category = favBtn.dataset.category;
                toggleFavorite(id, category);
                renderFavoritesPanel();
            }
        });

        // ========== MOBILE SIDEBAR DRAG RESIZE ==========
        const sidebar = document.getElementById('sidebar');
        const dragHandle = document.getElementById('dragHandle');
        let isDragging = false;
        let startY = 0;
        let startHeight = 0;

        function startDrag(e) {
            if (window.innerWidth > 768) return;
            isDragging = true;
            startY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
            startHeight = sidebar.offsetHeight;
            sidebar.classList.add('dragging');
            e.preventDefault();
        }

        function doDrag(e) {
            if (!isDragging) return;
            const currentY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
            const deltaY = startY - currentY;
            const newHeight = Math.min(Math.max(startHeight + deltaY, window.innerHeight * 0.15), window.innerHeight * 0.85);
            sidebar.style.height = newHeight + 'px';
            map.invalidateSize();
        }

        function endDrag() {
            if (!isDragging) return;
            isDragging = false;
            sidebar.classList.remove('dragging');
        }

        dragHandle.addEventListener('mousedown', startDrag);
        dragHandle.addEventListener('touchstart', startDrag, { passive: false });
        document.addEventListener('mousemove', doDrag);
        document.addEventListener('touchmove', doDrag, { passive: false });
        document.addEventListener('mouseup', endDrag);
        document.addEventListener('touchend', endDrag);
    </script>
</body>
</html>